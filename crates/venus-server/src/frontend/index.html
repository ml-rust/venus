<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Venus Notebook</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="/static/highlight-dark.css">
    <link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/editor/editor.main.css">
</head>
<body>
    <div id="app">
        <header class="header">
            <div class="header-left">
                <button class="btn btn-icon" id="variables-toggle-btn" title="Toggle Variable Explorer">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/>
                    </svg>
                </button>
                <h1 class="logo">Venus</h1>
                <span class="notebook-path" id="notebook-path"></span>
            </div>
            <div class="header-right">
                <button class="btn btn-icon btn-undo" id="undo-btn" title="Undo (Ctrl+Z)" disabled>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/>
                    </svg>
                </button>
                <button class="btn btn-icon btn-redo" id="redo-btn" title="Redo (Ctrl+Shift+Z)" disabled>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"/>
                    </svg>
                </button>
                <span class="toolbar-divider"></span>
                <span class="connection-status" id="connection-status">
                    <span class="status-dot"></span>
                    <span class="status-text">Connecting...</span>
                </span>
                <button class="btn btn-primary" id="run-all-btn" title="Run All Cells (Shift+Enter)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                    Run All
                </button>
                <button class="btn btn-secondary" id="sync-btn" title="Export to Jupyter Notebook (.ipynb)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Export
                </button>
                <!-- Graph toggle button hidden (plotr in development)
                <button class="btn btn-icon" id="graph-toggle-btn" title="Toggle Dependency Graph">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <circle cx="6" cy="6" r="3"/>
                        <circle cx="18" cy="6" r="3"/>
                        <circle cx="12" cy="18" r="3"/>
                        <path d="M6 9v3a6 6 0 0 0 6 6m6-9v3a6 6 0 0 1-6 6" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                </button>
                -->
            </div>
        </header>

        <main class="main-content">
            <aside class="variable-explorer" id="variable-explorer">
                <div class="explorer-header">
                    <h3>Variables</h3>
                    <button class="btn btn-icon btn-close" id="explorer-toggle-btn" title="Toggle Variable Explorer">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                        </svg>
                    </button>
                </div>
                <div class="explorer-content" id="explorer-content">
                    <div class="explorer-empty">No variables yet</div>
                </div>
            </aside>
            <div class="cells-container" id="cells-container">
                <!-- Cells will be rendered here -->
            </div>
            <!-- Graph panel hidden (plotr in development)
            <aside class="graph-panel hidden" id="graph-panel">
                <div class="graph-header">
                    <h3>Dependency Graph</h3>
                    <button class="btn btn-icon btn-close" id="graph-close-btn">&times;</button>
                </div>
                <div class="graph-container" id="graph-container"></div>
            </aside>
            -->
        </main>

        <footer class="footer">
            <div class="footer-left">
                <span id="cell-count">0 cells</span>
                <span class="separator">|</span>
                <span id="execution-time"></span>
            </div>
            <div class="footer-right">
                <button class="btn btn-text btn-sm" id="clear-outputs-btn" title="Clear all cell outputs">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                    Clear Outputs
                </button>
                <button class="btn btn-text btn-sm" id="restart-kernel-btn" title="Restart kernel (clear all state)">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                    </svg>
                    Restart Kernel
                </button>
                <span class="separator"></span>
                <span class="keyboard-hint">Shift+Enter: Run All</span>
            </div>
        </footer>
    </div>

    <!-- Toast notifications -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Highlight.js for syntax highlighting in markdown code blocks -->
    <script src="/static/highlight.min.js"></script>

    <!-- Marked for Markdown rendering - Load BEFORE Monaco to prevent AMD conflicts -->
    <script>
        // Disable AMD temporarily
        window.__define_backup = window.define;
        window.define = undefined;
    </script>
    <script src="/static/marked.min.js"></script>
    <script>
        // Restore AMD
        window.define = window.__define_backup;
        delete window.__define_backup;

        // Configure marked to use highlight.js for code blocks
        if (typeof marked !== 'undefined' && typeof hljs !== 'undefined') {
            marked.setOptions({
                highlight: function(code, lang) {
                    if (lang && hljs.getLanguage(lang)) {
                        try {
                            return hljs.highlight(code, { language: lang }).value;
                        } catch (err) {}
                    }
                    return hljs.highlightAuto(code).value;
                }
            });
        }
    </script>

    <!-- Monaco Editor Loader -->
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
    <!-- D3.js for graph visualization (hidden - plotr in development)
    <script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script>
    -->

    <!-- Application scripts -->
    <script src="/static/app.js"></script>
    <!-- Graph script hidden (plotr in development)
    <script src="/static/graph.js"></script>
    -->
    <script src="/static/lsp-client.js"></script>
</body>
</html>
